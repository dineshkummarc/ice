<link href="vendor/bespin/BespinEmbedded.css" type="text/css" rel="stylesheet">
<style type="text/css">
    #edit {
        width: 100%;
        height: 320px;
    }
</style>
<script src="vendor/bespin/BespinEmbedded.js"></script>
<div id="edit"></div>
<script type="text/javascript" charset="utf-8">
SC.ready(function() {
  var edit = document.getElementById("edit");
  var besp = tiki.require('embedded').useBespin(edit);
  var exports = {};
  exports.SC = SC;
  exports.setCode = function(st) {
    return besp.value = st;
  };  
  exports.getCode = function() {
    return besp.value;
  };
  exports.onCodeChange = function(fun) {
    besp.addEventListener('textChange', function() {
      fun(besp.value);
    });
  };
  exports.clearEvents = function() {
    besp.removeEventListener('textChange', function() {
      fun(besp.value);
    });
  };
  exports.honk = function() {
    alert("honk");
  };
  window.getExports = function() {
    return exports;
  }
});

</script>
<!-- todo move to vendor/bespin -->